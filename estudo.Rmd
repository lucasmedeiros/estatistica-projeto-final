---
title: "Estudo a partir de dados da embarcação de pessoas no Titanic"
author: "Jadson Luan, Jessé Souza e Lucas Medeiros"
output: html_document
---

```{r setup, include=FALSE}
library(corrplot)
library(dplyr)
library(tidyr)
library(gghighlight)
titanic_data  <- 
  na.omit(read.csv("data/train.csv", stringsAsFactors = FALSE)) %>%
  select(-c('Name', 'Ticket','Embarked','Cabin', 'PassengerId'))
```

## Descrição a respeito dos dados

 Para esse estudo, foi utilizado um arquivo contendo dados de 891 tripulantes do navio Titanic, que afundou na madrugado do dia 15 de abril de 1912, logo após ter colidido com um iceberg, onde das 2224 pessoas a bordo do navio, entre tripulantes, operários e  oficiais, somente 710 sobreviveram. Nosso objetivo, então, foi a partir da análise dos dados de 7 das variáveis presentes nesse dataset, identificar se houve influencia de um ou mais fatores na sobrevivência, ou não, do passageiro.

## Correlação de todas as variáveis
```{r, echo=FALSE}
corrplot(cor(titanic_data), method="pie", tl.col="black", type="lower")
```

## Sobreviventes da tragédia do Titanic

Utilizaremos a variável **Survived**, que diz se uma pessoa que embarcou no Titanic sobreviveu à tragédia ou não, seguindo o modelo abaixo:

- "1", caso tenha sobrevivido.
- "0", caso contrário.

## Análise da correlação com 'Survived'

Escolhemos as três variáveis com maior R-quadrado em relação a variável 'Survived' que são:

- **Pclass:** classe socio-econômica do passageiro  
1 = Classe alta  
2 = Classe média  
3 = Classe baixa  

- **Sex:** sexo do passageiro  
1 = Mulher  
0 = Homem  

- **Fare:** tarifa paga pelo passageiro para embarcar 

## Correlações das variáveis escolhidas
```{r}
cor(titanic_data$Survived, titanic_data$Pclass)
cor(titanic_data$Survived, titanic_data$Fare)
cor(titanic_data$Survived, titanic_data$Sex)
```

## Histograma das variáveis

```{r, echo=FALSE}
gather(titanic_data)%>%
  ggplot(aes(value)) +
    geom_histogram(bins = 10) +
      facet_wrap(~key, scales = 'free_x')
```

## Dispersão das variáveis
```{r, echo=FALSE}
plot(titanic_data$Survived)
plot(titanic_data$Pclass)
plot(titanic_data$Sex)
plot(titanic_data$Age)
plot(titanic_data$SibSp)
plot(titanic_data$Parch)
plot(titanic_data$Fare)
```

## Modelo de regressão
```{r, echo=FALSE}
model <- lm(formula = Survived ~ Sex + Fare + Pclass, data = titanic_data)
model
```

## Análise ANOVA
```{r}
anova(model)
```

# Calculando o R-quadrado
```{r, echo=FALSE}
rQuadrado <- summary(model)$r.squared
rQuadrado
```