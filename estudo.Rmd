---
title: "Estudo a partir de dados da embarcação de pessoas no Titanic"
author: "Jadson Luan, Jessé Souza e Lucas Medeiros"
output: html_document
---

```{r setup, include=FALSE}
library(corrplot)
library(dplyr)
library(tidyr)
library(gghighlight)
titanic_data  <- 
  na.omit(read.csv("data/train.csv", stringsAsFactors = FALSE)) %>%
  select(-c('Name', 'Ticket','Embarked','Cabin', 'PassengerId'))
```

## Descrição a respeito dos dados...
Adicionar alguma descrição

## Correlação de todas as variáveis
```{r, echo=FALSE}
corrplot(cor(titanic_data), method="pie", tl.col="black", type="lower")
```

## Análise da correlação com 'Survived'

Escolhemos as três variáveis com maior R-quadrado em relação a variável 'Survived' que são:

- **pclass:** classe socio-econômica do passageiro  
1 = Classe alta  
2 = Classe média  
3 = Classe baixa  

- **Sex:** sexo do passageiro  
1 = Mulher  
0 = Homem  

- **Fare:** tarifa paga pelo passageiro para embarcar 

## Correlações das variáveis escolhidas
```{r}
cor(titanic_data$Survived, titanic_data$Pclass)
cor(titanic_data$Survived, titanic_data$Fare)
cor(titanic_data$Survived, titanic_data$Sex)
```

## Modelo de regressão
```{r}
model <- lm(formula = Survived ~ Sex + Fare + Pclass, data = titanic_data)
```

## Análise ANOVA
```{r}
anova(model)
```

# Calculando o R-quadrado
```{r, echo=FALSE}
rQuadrado <- summary(model)$r.squared
rQuadrado
```

## Histograma
Abaixo está o histograma

```{r, echo=FALSE}
gather(titanic_data)%>%
  ggplot(aes(value)) +
    geom_histogram(bins = 10) +
      facet_wrap(~key, scales = 'free_x')
```
